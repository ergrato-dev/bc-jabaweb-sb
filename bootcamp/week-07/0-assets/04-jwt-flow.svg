<svg viewBox="0 0 900 520" xmlns="http://www.w3.org/2000/svg">
    <rect width="900" height="520" fill="#1e1e1e" />

    <text x="450" y="35" fill="#f0f0f0" font-family="Segoe UI, sans-serif" font-size="20"
        font-weight="bold" text-anchor="middle">Flujo de Autenticación con JWT</text>

    <!-- Client -->
    <rect x="30" y="80" width="120" height="400" rx="10" fill="#2d2d2d" stroke="#4fc3f7"
        stroke-width="2" />
    <text x="90" y="110" fill="#4fc3f7" font-family="Segoe UI, sans-serif" font-size="14"
        font-weight="bold" text-anchor="middle">Cliente</text>
    <text x="90" y="130" fill="#888" font-family="Segoe UI, sans-serif" font-size="10"
        text-anchor="middle">(Frontend/App)</text>

    <!-- Server -->
    <rect x="750" y="80" width="120" height="400" rx="10" fill="#2d2d2d" stroke="#81c784"
        stroke-width="2" />
    <text x="810" y="110" fill="#81c784" font-family="Segoe UI, sans-serif" font-size="14"
        font-weight="bold" text-anchor="middle">Servidor</text>
    <text x="810" y="130" fill="#888" font-family="Segoe UI, sans-serif" font-size="10"
        text-anchor="middle">(Spring Boot)</text>

    <!-- Step 1: Login Request -->
    <rect x="90" y="160" width="10" height="10" rx="5" fill="#f44336" />
    <text x="115" y="168" fill="#f44336" font-family="Segoe UI, sans-serif" font-size="12"
        font-weight="bold">1</text>
    <path d="M150 165 L720 165" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)" />
    <text x="435" y="155" fill="#f44336" font-family="Segoe UI, sans-serif" font-size="11"
        text-anchor="middle">POST /api/auth/login</text>
    <rect x="350" y="170" width="170" height="30" rx="5" fill="#3e2723" />
    <text x="435" y="190" fill="#ffab91" font-family="Consolas, monospace" font-size="9"
        text-anchor="middle">{"username", "password"}</text>

    <!-- Step 2: Validate & Generate Token -->
    <rect x="750" y="210" width="10" height="10" rx="5" fill="#ff9800" />
    <text x="775" y="218" fill="#ff9800" font-family="Segoe UI, sans-serif" font-size="12"
        font-weight="bold">2</text>
    <rect x="770" y="230" width="90" height="60" rx="5" fill="#263238" />
    <text x="815" y="250" fill="#ffb74d" font-family="Segoe UI, sans-serif" font-size="9"
        text-anchor="middle">Validar</text>
    <text x="815" y="265" fill="#ffb74d" font-family="Segoe UI, sans-serif" font-size="9"
        text-anchor="middle">credenciales</text>
    <text x="815" y="280" fill="#888" font-family="Segoe UI, sans-serif" font-size="8"
        text-anchor="middle">+ Generar JWT</text>

    <!-- Step 3: Return Token -->
    <rect x="90" y="300" width="10" height="10" rx="5" fill="#4caf50" />
    <text x="115" y="308" fill="#4caf50" font-family="Segoe UI, sans-serif" font-size="12"
        font-weight="bold">3</text>
    <path d="M720 305 L150 305" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowGreen)" />
    <text x="435" y="295" fill="#4caf50" font-family="Segoe UI, sans-serif" font-size="11"
        text-anchor="middle">200 OK</text>
    <rect x="320" y="310" width="230" height="30" rx="5" fill="#1b5e20" />
    <text x="435" y="330" fill="#a5d6a7" font-family="Consolas, monospace" font-size="9"
        text-anchor="middle">{"accessToken": "eyJhbG...", "refreshToken": "..."}</text>

    <!-- Client stores token -->
    <rect x="40" y="350" width="100" height="40" rx="5" fill="#263238" />
    <text x="90" y="365" fill="#888" font-family="Segoe UI, sans-serif" font-size="9"
        text-anchor="middle">Almacenar</text>
    <text x="90" y="380" fill="#888" font-family="Segoe UI, sans-serif" font-size="9"
        text-anchor="middle">token</text>

    <!-- Step 4: Protected Request -->
    <rect x="90" y="400" width="10" height="10" rx="5" fill="#2196f3" />
    <text x="115" y="408" fill="#2196f3" font-family="Segoe UI, sans-serif" font-size="12"
        font-weight="bold">4</text>
    <path d="M150 405 L720 405" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowBlue)" />
    <text x="435" y="395" fill="#2196f3" font-family="Segoe UI, sans-serif" font-size="11"
        text-anchor="middle">GET /api/tasks</text>
    <rect x="300" y="410" width="270" height="25" rx="5" fill="#0d47a1" />
    <text x="435" y="428" fill="#90caf9" font-family="Consolas, monospace" font-size="9"
        text-anchor="middle">Authorization: Bearer eyJhbGciOiJIUzI1NiIs...</text>

    <!-- Step 5: Validate Token & Return Data -->
    <rect x="750" y="440" width="10" height="10" rx="5" fill="#9c27b0" />
    <text x="775" y="448" fill="#9c27b0" font-family="Segoe UI, sans-serif" font-size="12"
        font-weight="bold">5</text>
    <rect x="770" y="455" width="90" height="35" rx="5" fill="#263238" />
    <text x="815" y="475" fill="#ce93d8" font-family="Segoe UI, sans-serif" font-size="9"
        text-anchor="middle">Validar JWT</text>

    <!-- Response -->
    <path d="M720 475 L150 475" stroke="#9c27b0" stroke-width="2" marker-end="url(#arrowPurple)" />
    <text x="435" y="465" fill="#9c27b0" font-family="Segoe UI, sans-serif" font-size="11"
        text-anchor="middle">200 OK - Protected Resource</text>

    <!-- Legend -->
    <rect x="200" y="60" width="500" height="15" rx="3" fill="#263238" />
    <text x="450" y="71" fill="#888" font-family="Segoe UI, sans-serif" font-size="10"
        text-anchor="middle">⚡ Stateless: El servidor NO almacena sesiones - El token contiene toda
        la información necesaria</text>

    <!-- Arrow markers -->
    <defs>
        <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <path d="M0,0 L0,6 L9,3 z" fill="#f44336" />
        </marker>
        <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <path d="M0,0 L0,6 L9,3 z" fill="#4caf50" />
        </marker>
        <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <path d="M0,0 L0,6 L9,3 z" fill="#2196f3" />
        </marker>
        <marker id="arrowPurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <path d="M0,0 L0,6 L9,3 z" fill="#9c27b0" />
        </marker>
    </defs>
</svg>
